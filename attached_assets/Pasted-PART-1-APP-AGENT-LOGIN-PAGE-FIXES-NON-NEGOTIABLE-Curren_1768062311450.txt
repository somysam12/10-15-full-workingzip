PART 1 â€” APP AGENT (LOGIN PAGE FIXES â€“ NON-NEGOTIABLE)
âŒ Current Problems (Confirmed from screenshots)

Paste icon tap does nothing

Keyboard doesnâ€™t open

Key not retained after successful login

White screen flash before login

Touch interception line visible (gesture overlay bug)

âœ… FIX 1 â€” Paste Icon MUST work + Keyboard MUST open
ğŸ”§ What your agent must do (EXACT):

DO NOT use setOnTouchListener on EditText
It breaks focus & keyboard.

âœ… Correct implementation (ONLY THIS):
licenseInput.setEndIconOnClickListener(v -> {
    ClipboardManager clipboard =
        (ClipboardManager) getSystemService(Context.CLIPBOARD_SERVICE);

    if (clipboard != null && clipboard.hasPrimaryClip()) {
        ClipData clip = clipboard.getPrimaryClip();
        if (clip != null && clip.getItemCount() > 0) {
            String pasted = clip.getItemAt(0).coerceToText(this).toString();
            licenseInput.getEditText().setText(pasted);
            licenseInput.getEditText().setSelection(pasted.length());

            licenseInput.getEditText().requestFocus();
            InputMethodManager imm =
                (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
            imm.showSoftInput(licenseInput.getEditText(),
                InputMethodManager.SHOW_IMPLICIT);
        }
    }
});

ğŸš« STRICT RULE

âŒ No onTouch

âŒ No custom gesture listeners

âŒ No overlay views on top of EditText

âœ… FIX 2 â€” Keyboard MUST open when user taps input
XML MUST contain:
android:focusable="true"
android:focusableInTouchMode="true"
android:inputType="textVisiblePassword"

Java MUST contain:
licenseInput.getEditText().setFocusableInTouchMode(true);

âœ… FIX 3 â€” Save key ONLY if key is VALID
After verify_key.php returns:
{ "status": "success" }

Save key:
prefs.edit()
    .putString("saved_key", enteredKey)
    .apply();

On app start:
String savedKey = prefs.getString("saved_key", "");
if (!savedKey.isEmpty()) {
    licenseInput.getEditText().setText(savedKey);
}

âŒ If login fails:
prefs.edit().remove("saved_key").apply();

âœ… FIX 4 â€” Remove WHITE SCREEN before login
Root cause:

Splash / Login activity has no background

FIX (MANDATORY):

In ALL of these:

activity_splash.xml

activity_login_v2.xml

activity_main.xml

Use same background color:

android:background="#1A1A2E"

ğŸŸ£ PART 2 â€” APP AGENT (ANNOUNCEMENT & MAINTENANCE)

Your backend JSON is CORRECT.
âŒ App agent is NOT parsing it properly.

âœ… REQUIRED JSON PARSING (NO EXTRA FIELDS)
App MUST read from:
announcement.enabled
announcement.title
announcement.message

maintenance.enabled
maintenance.message

ğŸ”§ REQUIRED LOGIC (NO SHORTCUTS)
Maintenance (BLOCKING):
if (config.maintenance.enabled) {
    showBlockingMaintenanceDialog(
        config.maintenance.message
    );
    return; // STOP APP
}

Announcement (ONE TIME ONLY):
if (config.announcement.enabled &&
    !prefs.getBoolean("ann_shown", false)) {

    showAnimatedAnnouncementDialog(
        config.announcement.title,
        config.announcement.message
    );

    prefs.edit().putBoolean("ann_shown", true).apply();
}

ğŸ¨ Announcement UI (Tell App Agent)

Design rules

Gradient background (purple â†’ blue)

Rounded card

Scale + fade animation

Centered modal

Button glow animation

Animation example:

scale 0.85 â†’ 1.0
alpha 0 â†’ 1
duration 300ms

ğŸŸ¢ PART 3 â€” WEBSITE AGENT (ANNOUNCEMENT NOT SHOWING â€“ ROOT CAUSE)
âŒ PROBLEM (Seen in screenshot)

Your admin announcement page saves data,
but app_config.php is NOT OUTPUTTING IT

âœ… WEBSITE AGENT MUST FIX THIS
In app_config.php

âŒ WRONG:

$announcement = null;


âœ… CORRECT:

$stmt = $pdo->query("SELECT * FROM announcements WHERE target='panel' AND status=1 ORDER BY id DESC LIMIT 1");
$ann = $stmt->fetch(PDO::FETCH_ASSOC);

$announcement = [
  "enabled" => $ann ? true : false,
  "title" => $ann['title'] ?? "",
  "message" => $ann['message'] ?? "",
  "type" => "info"
];


And then include in JSON:

"announcement" => $announcement

ğŸ”´ MAINTENANCE MODE BUG (CRITICAL)
âŒ Problem:

Maintenance ON but app still opens

Fix in app_config.php:
$app_enabled = ($settings['app_status'] === 'online');

$maintenance = [
  "enabled" => !$app_enabled,
  "message" => $settings['maintenance_message']
];


âŒ DO NOT rely only on frontend toggle

ğŸ”µ PART 4 â€” USER ACTIVITY (FINAL, CLEAN DESIGN)
Database MUST have:
user_sessions (
  id,
  license_key,
  device_id,
  login_time,
  logout_time,
  duration_seconds
)

On login:

INSERT new session

On heartbeat:

UPDATE duration

On logout / block:

SET logout_time

Admin Panel UX (Tell Website Agent)

âœ… Center card
âœ… Mobile friendly
âœ… Columns:

User

Key

Device

Login Time

Logout Time

Session Duration

Total Usage

Status

Block / Unblock

ğŸ§  FINAL VERDICT (IMPORTANT)

âŒ Backend is NOT your problem now

âŒ License logic is NOT broken

âŒ JSON is CORRECT

âœ… Your ONLY issues were:

Touch listeners breaking keyboar