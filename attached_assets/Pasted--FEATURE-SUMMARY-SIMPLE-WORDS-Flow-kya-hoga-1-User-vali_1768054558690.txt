ğŸ¯ FEATURE SUMMARY (SIMPLE WORDS)

Flow kya hoga:

1ï¸âƒ£ User valid license key paste karta hai â†’ login success
2ï¸âƒ£ First-time only â†’ app ek â€œProfile Setupâ€ page dikhata hai

User apna Name enter karega
3ï¸âƒ£ App:

Name

Device ID

Key

Login time

Session start
backend ko bhej dega
4ï¸âƒ£ Admin Panel me:

Har user ka record

Kab login hua

Kitni der use kiya

Kis device se
5ï¸âƒ£ Admin:

Name search kare

User block / unblock kare

Block karte hi â†’ key bhi disable

âš ï¸ GOLDEN RULE (DONO AGENTS KE LIYE)

âŒ Existing login logic / key verification / working API TOUCH NAHI KARNA

âœ… Sirf NEW endpoints, NEW tables, NEW screens

ğŸ§  ARCHITECTURE OVERVIEW (HIGH LEVEL)
APP
 â”œâ”€â”€ Login (already working âœ…)
 â”œâ”€â”€ Profile Setup (NEW)
 â”œâ”€â”€ Main App
 â””â”€â”€ Session Ping (background)

WEBSITE
 â”œâ”€â”€ verify_key.php (NO CHANGE âŒ)
 â”œâ”€â”€ register_user.php (NEW âœ…)
 â”œâ”€â”€ heartbeat.php (NEW âœ…)
 â””â”€â”€ Admin â†’ User Activity Page (NEW UI)

ğŸ—„ï¸ DATABASE CHANGES (WEBSITE AGENT)
1ï¸âƒ£ NEW TABLE: app_users
CREATE TABLE app_users (
  id INT AUTO_INCREMENT PRIMARY KEY,
  license_key VARCHAR(100),
  user_name VARCHAR(100),
  device_id VARCHAR(150),
  first_login_at DATETIME,
  last_login_at DATETIME,
  total_usage_seconds INT DEFAULT 0,
  is_blocked TINYINT(1) DEFAULT 0
);


ğŸ“Œ Purpose:

User identity

Block status

Usage tracking

2ï¸âƒ£ NEW TABLE: user_sessions
CREATE TABLE user_sessions (
  id INT AUTO_INCREMENT PRIMARY KEY,
  license_key VARCHAR(100),
  device_id VARCHAR(150),
  session_start DATETIME,
  session_end DATETIME,
  duration_seconds INT
);


ğŸ“Œ Purpose:

Detailed login history

Time spent per session

ğŸŒ WEBSITE AGENT â€“ BACKEND WORK
ğŸ”¹ API 1: register_user.php (NEW)
Input (POST):
license_key
device_id
user_name

Logic:

Check:

key exists

key active

not blocked

If first time:

insert into app_users

Else:

update last_login_at

Response:
{
  "status": "success",
  "message": "User registered"
}

ğŸ”¹ API 2: heartbeat.php (NEW â€“ session tracking)
Input (POST):
license_key
device_id

Logic:

Every 60 seconds:

update total_usage_seconds

keep session alive

ğŸ“Œ App band hote hi â†’ session_end update

ğŸ”¹ BLOCK LOGIC (VERY IMPORTANT)

Admin panel se:

is_blocked = 1

License key â†’ inactive

ğŸ‘‰ App side:

Agar API response me "blocked": true

App force logout + message

ğŸ–¥ï¸ ADMIN PANEL â€“ NEW PAGE (WEBSITE AGENT)
ğŸ“„ Page Name: User Activity
Columns:

User Name

License Key

Device ID

First Login

Last Login

Total Usage (HH:MM)

Status (Active / Blocked)

Action (Block / Unblock)

Features:

ğŸ” Search by User Name

ğŸ” Search by Key

â›” Block user

âœ… Unblock user

ğŸ§  Block = user + key both disabled

ğŸ“± APP AGENT â€“ APP SIDE CHANGES
1ï¸âƒ£ PROFILE SETUP SCREEN (NEW ACTIVITY)
Show only if:

Login success

User not registered yet

UI:

Title: â€œComplete Your Profileâ€

Input: Name

Button: Continue

On submit:

Call register_user.php

Save flag locally: profile_completed = true

âŒ Login logic touch nahi karna

2ï¸âƒ£ DEVICE ID (SAFE METHOD)
Settings.Secure.ANDROID_ID


Stable

No extra permission

Already allowed

3ï¸âƒ£ SESSION TRACKING (BACKGROUND)

On app open:

Start timer

Every 60 sec:

Call heartbeat.php

On app close / background:

End session

ğŸ“Œ Silent, no UI impact

ğŸ§¾ APP CONFIG JSON (NO BREAKING CHANGE)
ADD ONLY (donâ€™t remove anything):
"user_tracking": {
  "enabled": true,
  "heartbeat_interval_sec": 60
}

ğŸ›‘ BLOCK HANDLING (APP AGENT)

If any API returns:

"blocked": true


App should:

Clear session

Show dialog:

â€œYour access has been blocked. Contact support.â€

Redirect to login

ğŸ§ª TESTING ORDER (IMPORTANT)

1ï¸âƒ£ Verify key login (already working âœ…)
2ï¸âƒ£ First login â†’ profile screen
3ï¸âƒ£ Name saved â†’ admin panel visible
4ï¸âƒ£ Session time increments
5ï¸âƒ£ Block user from admin
6ï¸âƒ£ App instantly logs out
7ï¸âƒ£ Unblock â†’ login works again

ğŸ§© WHY THIS DESIGN IS CORRECT

âœ” No existing logic touched
âœ” Scalable
âœ” Searchable admin UI
âœ” Accurate time tracking
âœ” Clean separation of concerns
âœ” No hacks / no overlays

ğŸ§¨ FINAL STRICT MESSAGE FOR YOUR AGENTS

ğŸ”’ Login system is frozen

â• Only ADD:

new tables

new APIs

new screens

âŒ Do NOT refactor existing working code